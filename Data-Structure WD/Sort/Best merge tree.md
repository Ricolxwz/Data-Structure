## 最佳归并树

文件经过置换-选择排序后, 得到的是长度不等的初始归并段, 目的就是组织长度不等的初始归并段的归并排序, 使得IO的次数最少

### 归并树的性质

- 每个初始归并段看作一个叶子结点, 归并段的长度作为结点的权值, 则可以计算归并树的带权路径长度WPL=读磁盘次数=写磁盘次数
- 归并过程中磁盘的IO次数=WPL*2. 所以要让磁盘IO次数最少, 就要使归并树WPL最小--哈夫曼树!

### 初始归并段的数量无法构成严格k叉归并树的解决方案

需要补充几个长度为0的“虚段”, 再进行k叉哈夫曼树的构造

### 添加虚段的数量

k叉的最佳归并树一定是一棵严格的k叉树, 即树中只包含度为k、度为0的结点. 设度为k的结点有nk个, 度为0的结点有n0个, 归并树总结点数=n, 则:
- 初始归并段数量+虚段数量=n0
- n=n0+nk
- k*nk=n-1
- 根据上式可以推出: $n_k=\frac{n_0-1}{k-1}$

1. 若(初始归并段数量-1)%(k-1)=0, 说明刚好可以构成严格k叉树, 此时不需要添加虚段
2. 若(初始归并段数量-1)%(k-1)=u≠0, 则说明需要补充(k-1)-u个虚段